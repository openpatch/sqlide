importScripts("../lib/sql.js/sql-wasm.js");var q=initSqlJs({locateFile:i=>(self.location+"").replace("worker/sqljs-worker.js","")+"lib/sql.js/"+i}),s,g;function p(i){var t,e,r=i.data,o=r.config?r.config:{};try{switch(r&&r.action){case"open":return t=r.buffer,v(g,t&&new Uint8Array(t)),postMessage({id:r.id,ready:!0});case"exec":if(s===null&&v(g,void 0),!r.sql)throw"exec: Missing query string";return postMessage({id:r.id,results:s.exec(r.sql,r.params,o)});case"each":s===null&&v(g,void 0);var f=function(n){return postMessage({id:r.id,row:n,finished:!1})},u=function(){return postMessage({id:r.id,finished:!0})};return s.each(r.sql,r.params,f,u,o);case"export":t=s.export(),e={id:r.id,results:[{buffer:t}]};try{return postMessage(e)}catch{return postMessage(e)}case"close":return s&&s.close(),postMessage({id:r.id});default:throw new Error("Invalid action : "+(r&&r.action))}}catch(a){return postMessage({id:r.id,error:a.message})}}self.onmessage=i=>{s==null?q.then(t=>{g=t,s=v(t,void 0),p(i)}).catch(t=>(console.log(t),postMessage({id:globalThis.data.id,error:t.message}))):p(i)};function v(i,t){return s=new i.Database(t),s.create_function("isDate",function(e){if(e==null)return!0;if(typeof e!="string")return!1;var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;if(e.match(r)){var o=e.split("/"),f=e.split("-"),u=o.length,a=f.length;if(u>1)var n=e.split("/");else if(a>1)var n=e.split("-");if(n.length!=3)return!1;var c=parseInt(n[2]),l=parseInt(n[1]),d=parseInt(n[0]),b=[31,28,31,30,31,30,31,31,30,31,30,31];if((l==1||l>2)&&c>b[l-1])return!1;if(l==2){var h=!1;return(!(d%4)&&d%100||!(d%400))&&(h=!0),!(h==!1&&c>=29||h==!0&&c>29)}return!0}else return!1}),s.create_function("isDateTime",function(e){if(e==null)return!0;if(typeof e!="string")return!1;var r=/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01]) ([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;if(e.match(r)){var o=e.split(" "),f=o[0];if(f.length!=10)return!1;var u=parseInt(f.substring(8,10)),a=parseInt(f.substring(5,7)),n=parseInt(f.substring(0,4)),c=[31,28,31,30,31,30,31,31,30,31,30,31];if((a==1||a>2)&&u>c[a-1])return!1;if(a==2){var l=!1;return(!(n%4)&&n%100||!(n%400))&&(l=!0),!(l==!1&&u>=29||l==!0&&u>29)}return!0}else return!1}),s.create_function("isTime",function(e){if(e==null)return!0;if(typeof e!="string")return!1;var r=/^([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;return e.match(r)!=null}),s.create_function("concat",function(){if(console.log("Hier!"),arguments==null)return"";let e="";for(let r=0;r<arguments.length;r++)e+=""+arguments[r];return e}),s}
//# sourceMappingURL=sqljs-worker.js.map
