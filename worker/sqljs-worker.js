importScripts("../lib/sql.js/sql-wasm.js");var b=initSqlJs({locateFile:f=>(self.location+"").replace("worker/sqljs-worker.js","")+"lib/sql.js/"+f}),a,v;function m(f){var s,e,r=f.data,t=r.config?r.config:{};try{switch(r&&r.action){case"open":return s=r.buffer,g(v,s&&new Uint8Array(s)),postMessage({id:r.id,ready:!0});case"exec":if(a===null&&g(v,void 0),!r.sql)throw"exec: Missing query string";return postMessage({id:r.id,results:a.exec(r.sql,r.params,t)});case"each":a===null&&g(v,void 0);var u=function(i){return postMessage({id:r.id,row:i,finished:!1})},o=function(){return postMessage({id:r.id,finished:!0})};return a.each(r.sql,r.params,u,o,t);case"export":s=a.export(),e={id:r.id,results:[{buffer:s}]};try{return postMessage(e)}catch{return postMessage(e)}case"close":return a&&a.close(),postMessage({id:r.id});default:throw new Error("Invalid action : "+(r&&r.action))}}catch(n){return postMessage({id:r.id,error:n.message})}}self.onmessage=f=>{a==null?b.then(s=>{v=s,a=g(s,void 0),m(f)}).catch(s=>(console.log(s),postMessage({id:globalThis.data.id,error:s.message}))):m(f)};function g(f,s){return a=new f.Database(s),a.create_function("isDate",function(e){if(e==null)return!0;if(typeof e!="string")return!1;var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;if(e.match(r)){var t=e.split("/"),u=e.split("-"),o=t.length,n=u.length;if(o>1)var i=e.split("/");else if(n>1)var i=e.split("-");if(i.length!=3)return!1;var c=parseInt(i[2]),l=parseInt(i[1]),d=parseInt(i[0]),p=[31,28,31,30,31,30,31,31,30,31,30,31];if((l==1||l>2)&&c>p[l-1])return!1;if(l==2){var h=!1;return(!(d%4)&&d%100||!(d%400))&&(h=!0),!(h==!1&&c>=29||h==!0&&c>29)}return!0}else return!1}),a.create_function("isDateTime",function(e){if(e==null)return!0;if(typeof e!="string")return!1;var r=/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01]) ([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;if(e.match(r)){var t=e.split(" "),u=t[0];if(u.length!=10)return!1;var o=parseInt(u.substring(8,10)),n=parseInt(u.substring(5,7)),i=parseInt(u.substring(0,4)),c=[31,28,31,30,31,30,31,31,30,31,30,31];if((n==1||n>2)&&o>c[n-1])return!1;if(n==2){var l=!1;return(!(i%4)&&i%100||!(i%400))&&(l=!0),!(l==!1&&o>=29||l==!0&&o>29)}return!0}else return!1}),a.create_function("isTime",function(e){if(e==null)return!0;if(typeof e!="string")return!1;var r=/^([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;return e.match(r)!=null}),a.create_function("concat",function(e){if(arguments==null)return"";let r="";for(let t=0;t<arguments.length;t++)r+=""+arguments[t];return r}),a.create_function("month",function(e){var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;let t=e.match(r);return t?Number(t[1]):-1}),a.create_function("day",function(e){var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;let t=e.match(r);return t?Number(t[2]):-1}),a.create_function("year",function(e){var r=/^(\d{4})[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;let t=e.match(r);return t?Number(t[1]):-1}),a}
//# sourceMappingURL=sqljs-worker.js.map
